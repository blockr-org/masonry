(()=>{"use strict";Shiny;const a=()=>"_"+Math.ceil(1e7*Math.random()),n={},t=a=>n[a],e=(a,t)=>{const e=$(a).attr("id");t.group=e,((a,t)=>{n[`#${a}`]=t})(e,t),s(a,t),((a,n)=>{$(a).find(".masonry-item").on("mouseup",(a=>{$(a.target).trigger("resize")}))})(a),$(a).addClass("masoned"),d(a,t)},s=(a,n)=>{$(a).find(".masonry-row").each(((a,t)=>{i(t,n)}))},i=(n,t)=>{const e=$(n).data("masonry-minheight");$(n).css("min-height",e);const s=$(n).data("masonry-height");s&&$(n).css("height",s),$(n).attr("id",a()),m(n,t),o(n,t),d(n,t)},o=(a,n)=>{$(a).find(".masonry-item").each(((a,t)=>{r(t,n)}))},r=(n,t)=>{t.padding&&$(n).css("padding",t.padding),t.margin&&$(n).css("margin",t.margin);let e=$(n).data("masonry-width");e||(e=20),$(n).css("width",`${e}%`);let s=a();$(n).attr("id",s)},d=(a,n)=>{let t={multiDrag:!1,fallbackTolerance:2,animation:150,swap:!1};n.group&&(t.group=n.group),new Sortable(a,t)},m=(a,n)=>{let t=[];if($(a).find(".masonry-item").each(((a,n)=>{t.push($(n).data("masonry-width")||.2)})),0==t.length)return;let e=t.reduce(((a,n)=>a+n));if(e<100){let n=100-e;$(a).find(".masonry-item").last().data("masonry-width",t[t.length-1]+n)}let s=e-100;$(a).find(".masonry-item").last().data("masonry-width",t[t.length-1]-s)};jQuery.fn.extend({masonry:function(a){((a,n)=>{((a,n)=>{$(a).hasClass("masonry-main")?e(a[0],n):$(a).find(".masonry-main").each(((a,t)=>{e(t,n)}))})(this,n=n||{})})(0,a)}}),Shiny.addCustomMessageHandler("masonry-init",(a=>{$(`${a.target}`).masonry()})),Shiny.addCustomMessageHandler("masonry-add-row",(a=>{let n=`<div \n    class='masonry-row d-flex ${a.classes}'\n    data-masonry-minheight = ${a.min_height}\n    data-masonry-height = ${a.height}\n    ></div>`,e=$(`${a.target}`).find(".masonry-main-content");"bottom"==a.position&&e.append(n),"top"==a.position&&e.prepend(n);const s=t(a.target);$(`${a.target}`).masonry(s)})),Shiny.addCustomMessageHandler("masonry-add-item",(a=>{let n=`<div class='masonry-item ${a.classes}'>${a.item}</div>`;console.log(a),console.log(`.masonry-row:eq(${a.row_index})`);let e=$(`${a.target}`).find(".masonry-main-content").find(`.masonry-row:eq(${a.row_index})`);"end"==a.position&&e.append(n),"start"==a.position&&e.prepend(n);let s=t(a.target);$(`${a.target}`).masonry(s)}))})();